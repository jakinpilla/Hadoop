---
title: "Hadoop_2nd_Report"
author: "Kim Jeong Gyu"
date: "`r format(Sys.time(), '%Y-%m-%d')`"
output:
  html_document:
    theme: cerulean
---

<style type="text/css">

body{ /* Normal  */
      font-size: 11px;
  }
td {  /* Table  */
  font-size: 9px;
}
h1.title {
  font-size: 38px;
  color: DarkRed;
}
h1 { /* Header 1 */
  font-size: 28px;
  color: DarkBlue;
}
h2 { /* Header 2 */
    font-size: 22px;
  color: DarkBlue;
}
h3 { /* Header 3 */
  font-size: 18px;
  color: DarkBlue;
}
h4 { /* Header 4 */
  font-size: 14px;
  color: DarkBlue;
}
code.r{ /* Code block */
    font-size: 11px;
}
pre { /* Code block - determines code spacing between lines */
    font-size: 10px;
}
</style>


```{r setup, include=FALSE, echo=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message=FALSE)
```

### 빅데이터분산컴퓨팅 기말과제

###### 1. 데이터의 형식은 정형, 비정형, 반정형으로 크게 구분할 수 있다. 3가지 형식의 정의와 특징을 설명하라
 - 정형데이터(Structured Data) : 일반적으로 스키마가 있으며 연산가능한 형태의 데이터를 정형데이터라 한다. 정형 데이터는 관계형 데이터베이스 시스템의 테이블과 같이 고정된 컬럼에 저장되는 데이터와 파일, 그리고 지정된 행과 열에 의해 데이터의 속성이 구별되는 엑셀 형태의 데이터 등이 있다. 스키마 구조를 가지고 있어 데이터를 테이블 탐색, Column(열) 구조 탐색, Row(행) 탐색 등을 통해 데이터를 탐색할 수 있다.
 
 - 반정형 데이터(Semi-Structured Data) : 데이터 내부에 정형 데이터의 스키마에 해당하는 메타데이터(태그 혹은 기타 마커)를 가지고 있어 메타데이터를 통해 데이터 내에 레코드와 필드 계층 등이 강제되는 데이터를 반정형 데이터라 한다. JSON, XML, 로그(웹 로그, 센서 데이터) 등이 있다. 보통 API 형태로 제공되고 파싱 기술이 요구된다. 반정형 데이터에서 동일 클래스에 속해있는 엔티티는 함께 그룹되어 있더라도 각기 다른 특성을 지닐 수 있으며, 특성의 순서가 중요하지 않다. 분석을 위한 데이터 처리를 위해 데이터의 메타구조를 해석해 정형 데이터 형태로 바꿀 수 있는 아키텍쳐 구조를 수정해야 한다.
 
 - 비정형 데이터(Unstructured Data) : 일반적으로 스키마가 없으며 연산불가능한 형태의 데이터를 비정형 데이터라 한다. 비정형 데이터는 데이터 세트가 아닌 하나의 데이터가 수집 데이터로 객체화되어 있다. 텍스트, 이미지, 동영상 등이 있다. 분석을 위한 처리를 위해 텍스트나 파일을 파싱해 메타구조를 갖는 데이터 셋형태로 바꾸로 정형 데이터 구조로 최종 수정해야 한다.

###### 2. 데이터를 구조화할 때 전통적인 정형 대신 반정형(Semi Structure)을 권장하는 이유를 설명하라.

 - 오늘날 기업이 생성하는 데이터의 대부분은 반정형 혹은 비정형 데이터이고 처음부터 이러한 반정형, 비정형 데이터를 정형 데이터로 변환하여 구조화하는 것은 상대적으로 많은 노력과 자원을 사용하게 된다.   
 
 - 반정형 데이터는 정형 데이터에 비해 스키마가 유연하거나 심지어 생략될 수도 있다. 데이터 구조에 대한 최소한의 규칙만 있으면 되기 때문이다. 이는 데이터를 구조화하는 노력을 많이 감소시켜 준다. 반정형 데이터는 필요시 내포된 메터구조를 해석해 정형 데이터로 변환시킬 수 있다. 
 
 - 특히 하둡 시스템의 경우, 처리 시점에 데이터를 해석하여 처리하는데 Schema-on-read라는 이러한 특성으로 인해 스키마의 유연성을 제공하고 데이터 조회의 필요한 과도한 비용을 피할 수 있어 데이터 구조화에 효율적인 솔루션으로 사용할 수 있다. 

###### 3. 아래 자료는 2개의 테이블 구조와 값이다. 이를 JSON 형식으로 표현하라. 단, 1개의 JSON 파일로 2개의 테이블의 구조와 값을 표현해야 함.

```
{
"TA":[{"C1":"hadoop", "C2": 11},
      {"C1":"hive", "C2": 12},
	  {"C1":"pig", "C2" : 13 }],
	    
"TB":[{"no": 1, "name":"kim", "score":5.0},
      {"no": 2, "name":"lee", "score":2.3},
	  {"no": "", "name":"", "score":""}]
}
```

###### 4. 실시간 수집 기술인 Kafka의 3가지 핵심 구성을 적고, 각각의 역할을 설명하라.

 - producer : 특정 topic(데이터베이스의 테이블의 해당하는 개념) 메시지 생성 후 해당 메시지를 broker에 전달
  - broker : topic을 기준으로 메시지를 관리, 클러스터로 구성되어 동작, 클러스터 내 broker에 대한 분산 처리는 주키퍼가 담당
 - consumer : Broker가 전달받은 메시지를 topic별로 쌓아놓으면 해당 topic을 구독하는 consumer들이 메시지를 가져가서 처리
 
![kafka](kafka.png)
 
###### 5. Hive에서 moives라는 테이블을 생성하고 m.csv라는 파일 데이터를 불러들였다.(Load) movies 테이블의 테이블 이름과 그 컬럼의 정보는 어디에 저장되는가? 그리고 m.csv 파일이 저장되고 있는 물리적인 위치는 어디인가?

 - 테이블의 테이블 이름과 그 컬럼의 정보는 메타스토어(Metastore)에 저장됨. 이 곳은 일종의 테이블 목록 등의 정보를 가진 네임스페이스이며 컬럼 타입 및 물리적 레이아웃 등 테이블의 명세를 저장하는 하이브 메타데이터의 핵심 저장소임. 기본적으로 메타데이터 서비스는 하이브와 동일한 JVM에서 실행되고 로컬디스크에 저장되는 내장형 Derby 혹은 MySQL 데이터 인스턴스를 포함함.
 
 - 관리자가 데이터를 movies 테이블에 로드하면 그 데이터는 하이브의 웨어하우스 디렉토리로 이동한다. 즉, 
``` 
LOAD DATA INPATH 'm.csv' INTO TABLE movies; 
```
위와 같이 데이터를 테이블에 로드하면
```
hdfs://user/hive/warehouse/movies
```
로 데이터가 이동하게 된다.

###### 6. 연관규칙의 지지도, 신뢰도, 향상도의 의미를 설명하라.

- 지지도(support) : 전체 거래 중에서 품목 A, B가 동시에 포함되는 거래의 비율. 전체 거래 중 A, B를 동시에 포함하는 거래가 어느 정도인지를 나타내주며, 전체 구매 경향을 파악할 수 있음.
- 신뢰도(confidence) : 품목 A가 포함된 거래 중에서 품목 A, B를 동시에 포함하는 거래일 확률이 어느 정도인가를 나타내 주며 연관성의 정도를 파악할 수 있음. 일종의 조건부 확률의 개념으로 "품목 A를 구매한 사람이 품목 B도 구매하더라."라고 말할 수 있는 확률임.
- 향상도(lift) : 품목 B를 구매한 고객 대비 품목 A를 구매한 후 품목 B를 구매하는 고객에 대한 확률을 의미. 만일 향상도가 1이면 두 품목이 서로 독립(구매가 서로 관련이 없음)이란 의미이며, 1보다 크면 두 품목이 서로 양의 관계로 품목 B를 구매할 확률보다 품목 A를 구매한 후 품목 B를 구매할 확률이 더 높다는 것을 의미함. 한편, 향상도가 1보다 작으면 두 품목이 서로 음의 관계로 품목 A와 B는 서로 연관성이 없다는 의미임.

###### 7. 연관규칙의 지지도, 신뢰도, 향상도의 계산식을 먼저 쓰고, 최종적으로는 $T, N(A), N(B), N(A \cap B)$ 로 표현할 수 있도록 계산식을 변경하라.

$$Support = P(A \cap B) =  \frac{N(A \cap B)}{N(T)}$$

$$Confidence= P(B|A) = \frac{P(A \cap B)}{P(A)} = \frac{N(A \cap B)}{N(A)} $$

$$Lift= \frac{P(B|A)}{P(B)} = \frac{P(A \cap B)}{P(A)P(B)} = \frac{N(T)N(A \cap B)}{N(A)N(B)} $$

###### 8. 아래 자료는 장바구니 데이터이다. 이를 이용하여 (A -> B)의 신뢰도와 향상도를 계산하라(계산 과정에 필요한 모든 계산 테이블과 그 값을 명시해야 함.)

|장바구니 No | 상품 목록 |
|:--:|:--:|
| 1 | 커피, 우유 |
| 2 | 커피, 프림, 설탕, 우유 |
| 3 | 커피, 컵, 우유, 쥬스 | 


```{r}
tran = data.frame(No = c(1, 2, 3), Prod = c())
```


